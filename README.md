# A Short Cut Algorithm for Solubility of Salt Ternary Phase Diagram 一种二盐溶液溶解度曲面的简捷算法

SunGuoming LiZejian

孙国铭 李泽健

2021年12月30日

Professor: Yuan Xigang

导师：袁希钢

State Key Laboratory of Chemical Engineering, School of Chemical Engineering and Technology, Tianjin University 

天津大学化工学院 化学工程国家重点实验室

The right of Files is protected by license GPL 3.0.

权限受GPL 3.0证书保护

Copyright (C) 2021  Guoming Sun(孙国铭)

## how to use 如何使用

Just run the file calculate_r.m by MATLAB R2017b.
Then you will get a series .xls files,
which are the result files.

在MATLAB R2017b中运行文件calculate_r.m，即可得到一系列 .xls 文件，这些文件就是计算结果。

## Document 文档

Now just Chinese version. We will add English version in future. 

## 第一部分 计算原理
### 如何得到结果
反应的吉布斯自由能变，等于反应平衡常数的对数值

由此可以计算出反应平衡常数

对于饱和溶液，离子积等于平衡常数

对于不饱和溶液，离子积小于平衡常数

稀溶液具有依数性，溶质浓度越高凝固点越低

### 如何根据结果解释现象
改变温度，吉布斯自由能变会发生变化，平衡常数也会变化

当离子积大于平衡常数时，溶液过饱和，系统不稳定，盐会析出，使离子浓度降低，直至等于平衡常数，达到稳定状态

同时，温度降低，如果低于溶液的冰点，冰会析出。冰可以近似为纯净的水，析出之后，溶液浓度会升高。降温的终点是，当前K所能达到的最大浓度，决定的溶液凝固点依然高于当前温度，则体系完全结冰。这也是溶解度曲线的终点。

### 盐的电离

$$\\
L{i_2}S{O_4} \Leftrightarrow 2L{i^ + } + SO_4^{2 - }\\
\Delta G = \ln K\\
Q = {[L{i^ + }]^2}[SO_4^2]
$$

当$L{i_2}S{O_4}$溶液饱和时，有

$$Q = K$$

### $Q$的计算

本身，$Q$的值应该用活度来计算

但这里为了追求计算高效，模型简洁，首先尝试使用浓度来计算，如果出现偏差，无法解释实验现象，再换活度

### $K$的计算

理论上，计算$K$有两种途径

方法一是测饱和溶液的$Q$

也就是先测溶解度，再测量或者计算饱和溶液的活度，根据溶解度和活度计算饱和溶液的$Q$，也就得到了$K$

方法二是计算过程的吉布斯自由能变

$G=H-TS$，分别算出过程的焓变和熵变即可得到吉布斯自由能变，进而得到K

这里，我们首先尝试使用方法一。并且忽略活度的影响，使用浓度代替活度进行计算

需要注意的是，这里我们虽然忽略了活度，但是因为在计算K和Q的时候都忽略了活度系数，所以并不是相当于把活度系数按1处理，而是相当于把活度系数按常数处理。只是由于没有实际测量，我们不知道这个常数是多少。


### 冰点的计算

根据物理化学，冰点的降低与浓度是线性关系

根据前文的计算原理，溶解度曲线的终点就是溶液的冰点，并且此时，溶液是饱和溶液

可以查到两种盐的溶解度曲线，得到它们终点的温度和浓度

由于水的冰点近似为0度，简单做除法就可以得到线性系数

两种盐对冰点浓度的影响叠加，即加法，可以构成一个 浓度-浓度-温度 空间的平面，坐标轴原点所在的一侧为结冰区，另一侧为稳定区

### 如何求解共饱和点

这里已知K1，K2，不知浓度

构建以下方程组，三个未知数，三个方程，求解即可

$${K_1} = {[L{i^ + }]^2}[SO_4^{2 - }]$$
$${K_2} = [C{o^{ 2  + }}][SO_4^{2 - }]$$
$$[SO_4^{2 - }] = [C{o^{ 2  + }}] + 2[L{i^ + }]$$

解出
${[L{i^ + }]^2}$,
$[C{o^{ 2  + }}]$,
$[SO_4^{2 - }]$,即共饱和点。

### 如何求解饱和状态

以固定Li的浓度，求Co盐的溶解度为例

Co盐饱和，知道Co盐的K

Li盐的浓度固定，知道Li盐的浓度

两个未知数两个方程，求解即可

$$\begin{array}{l}
{Q_{Co 2  + }} = [C{o^{ 2  + }}][SO_4^{2 - }]\\
[SO_4^{2 - }] = [C{o^{ 2  + }}] + 2[L{i^ + }]
\end{array}$$

解出
$[C{o^{ 2  + }}]$,
$[SO_4^{2 - }]$,即饱和状态。

## 第二部分 程序是如何工作的

### 第一步

根据不同温度下的溶解度数据，计算不同温度下两种盐的K，得到K1，K2

根据溶解度曲线的终点（降温至刚好完全结冰的状态），计算冰点平面

### 第二步

给定一个温度

根据K1，K2，求解浓度方程，得到两种盐同时饱和的状态点

分别降低其中一种盐的浓度，求解另一种盐的溶解度，得到饱和状态线

求解过程使用的求解算法是levenberg-marquardt法

### 第三步

将不同温度的饱和状态线绘制在一期，得到曲面。与冰点平面绘制在一起，得到完整的相图

## 第三部分 该算例的求解参数

### 溶解度数据的获取

由李泽健从文献中获取。

### 方程求解方法和参数

#### 结冰曲面的计算

由溶解度数据，可以知道$L{i_2}S{O_4}$的冰点为 -20°C，该温度下的溶解度为36.69g/100g

类似的，$C{o}S{O_4}$的冰点为 -3.3°C，该温度下的溶解度为25.32g/100g

这样，我们可以直接写出结冰曲面的方程

$$\frac{{20}}{{36.69}}m(L{i_2}S{O_4}) + \frac{{3.3}}{{25.52}}m(CoS{O_4}) + T = 0$$

#### 饱和曲线和共饱和点的计算

方程求解均使用levenberg-marquardt法，迭代最大次数为6000次，残差计算最大次数为6000次，其余参数使用MATLAB R2017b 中fsolve函数的默认值。
